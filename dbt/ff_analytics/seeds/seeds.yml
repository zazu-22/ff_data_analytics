version: 2

seeds:
  # NOTE: dim_player_id_xref has been migrated to a staging model (stg_nflverse__ff_playerids)
  # See: dbt/ff_analytics/models/core/dim_player_id_xref.sql (backward compatibility alias)
  # Migration date: 2025-11-06
  # Reason: Eliminates CSV parsing issues, ensures always-fresh data, aligns with architecture intent

  - name: dim_timeframe
    description: "Maps TRANSACTIONS timeframe strings to structured season/week/period"
    columns:
      - name: timeframe_string
        description: "Original commissioner timeframe string"
        data_tests:
          - not_null
          - unique
      - name: season
        description: "NFL season year"
        data_tests:
          - not_null
      - name: sort_sequence
        description: "Chronological sort order"
        data_tests:
          - not_null
          - unique

  - name: dim_franchise
    description: "Franchise ownership history (SCD Type 2)"
    columns:
      - name: franchise_id
        description: "Franchise identifier (F001-F012)"
        data_tests:
          - not_null
      - name: owner_name
        description: "Owner during this period"
        data_tests:
          - not_null
      - name: gm_tab
        description: "Google Sheet tab name (matches gm_tab in raw commissioner data)"
        data_tests:
          - not_null
      - name: season_start
        description: "First season of ownership"
        data_tests:
          - not_null
      - name: season_end
        description: "Last season of ownership (9999 = current)"
        data_tests:
          - not_null

  # NOTE: dim_pick has been migrated to a dbt model (models/core/dim_pick.sql)
  # See: dbt/ff_analytics/models/core/dim_pick.sql
  # Migration date: 2025-11-07
  # Reason: Incorporates compensatory picks from FAAD, TBD picks, full dimensional model
  # Old seed archived: seeds/_archive/dim_pick.csv

  - name: dim_scoring_rule
    description: "Fantasy scoring rules (SCD Type 2)"
    columns:
      - name: rule_id
        description: "Unique rule identifier"
        data_tests:
          - not_null
          - unique
      - name: stat_category
        description: "Stat category"
        data_tests:
          - not_null
          - accepted_values:
              config:
                severity: error
              arguments:
                values: ['passing', 'rushing', 'receiving', 'idp', 'team_dst', 'kicking']
      - name: stat_name
        description: "Stat name"
        data_tests:
          - not_null
      - name: points_per_unit
        description: "Points awarded per unit"
        data_tests:
          - not_null
      - name: valid_from_season
        description: "First season this rule is valid"
        data_tests:
          - not_null
      - name: is_current
        description: "Is this the current rule?"
        data_tests:
          - not_null

  - name: dim_name_alias
    description: "Player name aliases for fuzzy matching from TRANSACTIONS"
    columns:
      - name: alias_name
        description: "Alternate spelling/format"
        data_tests:
          - not_null
      - name: canonical_name
        description: "Canonical name from dim_player_id_xref"
        data_tests:
          - not_null
      - name: alias_type
        description: "Type of alias (typo, nickname, variation, etc.)"
      - name: notes
        description: "Additional context about the alias"
      - name: position
        description: "Override position for disambiguation"
      - name: treat_as_position
        description: "Position to use when matching this alias"

  - name: dim_team_conference_division
    description: "NFL conference and division mappings"
    columns:
      - name: team_abbr
        description: "Team abbreviation"
        data_tests:
          - not_null
          - unique

  - name: dim_league_rules
    description: "Core league configuration rules (SCD Type 2)"
    columns:
      - name: rule_id
        description: "Rule version identifier"
        data_tests:
          - not_null
          - unique
      - name: valid_from_season
        description: "First season this rule set is valid"
        data_tests:
          - not_null
      - name: valid_to_season
        description: "Last season this rule set is valid (9999 = ongoing)"
        data_tests:
          - not_null
      - name: is_current
        description: "Is this the current rule set?"
        data_tests:
          - not_null
          - accepted_values:
              config:
                severity: error
              values: [true, false]
      - name: annual_salary_cap
        description: "Base salary cap per season ($)"
        data_tests:
          - not_null
      - name: roster_active_limit
        description: "Maximum active roster size"
        data_tests:
          - not_null
      - name: roster_total_defined_slots
        description: "Total defined roster slots (active + taxi + IR)"
        data_tests:
          - not_null

  - name: dim_rookie_contract_scale
    description: "Rookie contract amounts by draft position"
    columns:
      - name: draft_position_start
        description: "Starting draft position for this bucket"
        data_tests:
          - not_null
      - name: draft_position_end
        description: "Ending draft position for this bucket"
        data_tests:
          - not_null
      - name: position_bucket_label
        description: "Label for this position bucket (e.g., R1.P1-2)"
        data_tests:
          - not_null
          - unique
      - name: year1_amount
        description: "Year 1 contract amount ($)"
        data_tests:
          - not_null
      - name: year4_option_amount
        description: "Year 4 option amount ($)"
        data_tests:
          - not_null

  - name: dim_cut_liability_schedule
    description: "Dead cap percentage schedule by contract year"
    columns:
      - name: contract_year
        description: "Year of contract (1-5)"
        data_tests:
          - not_null
          - unique
          - accepted_values:
              config:
                severity: error
              values: [1, 2, 3, 4, 5]
      - name: dead_cap_pct
        description: "Percentage of contract amount owed as dead cap"
        data_tests:
          - not_null
      - name: rounding_rule
        description: "Rounding method for dead cap calculation"
        data_tests:
          - not_null
          - accepted_values:
              config:
                severity: error
              values: ['ceil']

  - name: dim_rfa_compensation_schedule
    description: "RFA compensation pick schedule by contract value"
    columns:
      - name: schedule_id
        description: "Schedule entry identifier"
        data_tests:
          - not_null
          - unique
      - name: valid_from_season
        description: "First season this schedule is valid"
        data_tests:
          - not_null
      - name: valid_to_season
        description: "Last season this schedule is valid"
        data_tests:
          - not_null
      - name: avg_annual_min
        description: "Minimum average annual value ($)"
        data_tests:
          - not_null
      - name: compensation_pick_round
        description: "Compensation pick round (1, 2, or 3)"
        data_tests:
          - not_null
          - accepted_values:
              config:
                severity: error
              values: [1, 2, 3]

  - name: dim_position_slot_eligibility
    description: "Position eligibility for roster slots"
    columns:
      - name: position
        description: "Player position"
        data_tests:
          - not_null
          - unique
      - name: eligible_starter_slots
        description: "Pipe-delimited starter slots (e.g., RB|FLEX)"
        data_tests:
          - not_null
      - name: eligible_bench_standard
        description: "Can use standard bench slots"
        data_tests:
          - not_null
      - name: eligible_bench_idp_only
        description: "Can use IDP-only bench slots"
        data_tests:
          - not_null

  - name: dim_position_translation
    description: "Maps fantasy-generic positions (DL, LB, DB) to NFL-specific positions (DE, DT, CB, S, etc.) for cross-dataset matching"
    columns:
      - name: fantasy_position
        description: "Fantasy/projection position (e.g., DL, DB, LB)"
        data_tests:
          - not_null
      - name: nfl_position
        description: "NFL roster position (e.g., DE, DT, CB, S)"
        data_tests:
          - not_null
      - name: position_type
        description: "Position category (offense, defense, special_teams)"
        data_tests:
          - not_null
          - accepted_values:
              config:
                severity: error
              arguments:
                values: ['offense', 'defense', 'special_teams']
      - name: match_priority
        description: "Priority for matching (100 = exact, 95 = compatible)"
        data_tests:
          - not_null
      - name: notes
        description: "Explanation of mapping relationship"

  - name: seed_faad_award_sequence_snapshot
    description: "Baseline snapshot of FAAD award sequences for immutability testing (v2 architecture). Updated when new FAAD completes."
    columns:
      - name: transaction_id
        description: "Transaction ID from commissioner sheet"
        data_tests:
          - not_null
          - unique
      - name: season
        description: "Season year"
        data_tests:
          - not_null
      - name: faad_award_sequence
        description: "Chronological 1-indexed sequence of FAAD awards within season (immutable baseline)"
        data_tests:
          - not_null
