[sqlfluff]
templater = dbt
dialect = duckdb
exclude_rules = L034,L044,RF02,RF03,RF04,RF06,CV06,LT02,LT09
# Increase file size limit to handle large models
large_file_skip_byte_limit = 30000
# IMPORTANT: Do not fix files with parsing/templating errors
# This prevents sqlfluff-fix from modifying files it can't fully parse
fix_even_unparsable = false
# Exclude third-party packages, build artifacts, archive directories, and test files from linting
exclude_dirs = .venv,target,dbt_packages,_archive,tests
# Exclude files with DuckDB-specific syntax that SQLFluff cannot parse:
# - Staging models use read_parquet() with named parameters
# - Core models with DuckDB-specific functions (list_sum, try_cast, regexp_matches, etc.)
# - Mart models with DuckDB-specific functions
# Note: Patterns are relative to the config file location
exclude = **/.venv/**,**/target/**,**/dbt_packages/**,dbt/ff_data_transform/analyses/_archive/**,**/tests/**,dbt/ff_data_transform/models/staging/stg_*__*.sql,dbt/ff_data_transform/models/core/dim_player_contract_history.sql,dbt/ff_data_transform/models/core/fact_league_transactions.sql,dbt/ff_data_transform/models/core/intermediate/int_pick_*.sql,dbt/ff_data_transform/models/marts/mart_contract_snapshot_current.sql,dbt/ff_data_transform/models/marts/mart_real_world_actuals_weekly.sql
# Reduce noise from dbt macro warnings
warnings_file_skip = **/.venv/**,**/target/**,**/dbt_packages/**

[sqlfluff:templater:dbt]
project_dir = dbt/ff_data_transform
profiles_dir = dbt/ff_data_transform
profile = ff_duckdb
target = local

[sqlfluff:indentation]
# Match sqlfmt's default 4-space indentation
tab_space_size = 4
indented_then = false
indented_then_contents = false
indent_unit = space

[sqlfluff:rules:capitalisation.keywords]
# DuckDB functions are case-insensitive
capitalisation_policy = lower

[sqlfluff:rules:aliasing.table]
# Allow implicit table aliasing in staging (raw provider schemas)
aliasing = implicit

[sqlfluff:templater:jinja]
apply_dbt_builtins = True
